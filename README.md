# tarant-kv (KV-Store API на базе Tarantool)

Этот проект реализует API для KV-хранилища с использованием Tarantool в качестве базы данных. API предназначен для выполнения операций аутентификации пользователей, записи и чтения данных пачками с поддержкой параллельной обработки для повышения производительности.

## Функциональные возможности

- **Аутентификация пользователей**: Безопасная авторизация с получением токена.
- **Авторизация пользователей**: Все запросы к API требуют валидный токен, передаваемый в заголовке `Authorization`.
- **Операции с данными пачками**: Поддержка пакетных операций записи и чтения пар ключ-значение.
- **Обработка ошибок**: Корректная обработка некорректных запросов и ошибок базы данных.

## Эндпоинты

### 1. Вход в систему (Login)

**Эндпоинт**: `POST /api/login`

**Описание**: Аутентифицирует пользователя и возвращает токен авторизации.

**Пример запроса**:

```json
{
    "username": "your_username",
    "password": "your_password"
}
```

**Пример ответа**:

```json
{
    "token": "your_generated_token"
}
```

**Коды ошибок**:
- `400 Bad Request`: Отсутствуют или некорректные учетные данные.
- `401 Unauthorized`: Неверное имя пользователя или пароль.

### 2. Запись данных пачками

**Эндпоинт**: `POST /api/write`

**Описание**: Записывает пачку пар ключ-значение в базу данных.

**Пример запроса**:

```json
{
    "data": {
        "key1": "value1",
        "key2": "value2",
        "key3": 1
    }
}
```

**Пример ответа**:

```json
{
    "status": "success"
}
```

**Коды ошибок**:
- `400 Bad Request`: Некорректный формат данных.
- `401 Unauthorized`: Неверный или отсутствующий токен.
- `500 Internal Server Error`: Ошибка базы данных.

### 3. Чтение данных пачками

**Эндпоинт**: `POST /api/read`

**Описание**: Считывает пачку пар ключ-значение из базы данных.

**Пример запроса**:

```json
{
    "keys": ["key1", "key2", "key3"]
}
```

**Пример ответа**:

```json
{
    "data": {
        "key1": "value1",
        "key2": "value2",
        "key3": 1
    }
}
```

**Коды ошибок**:
- `400 Bad Request`: Отсутствуют или некорректные ключи.
- `401 Unauthorized`: Неверный или отсутствующий токен.
- `500 Internal Server Error`: Ошибка базы данных.

## Инструкция по запуску

1. **Клонирование репозитория**:

   ```bash
   git clone https://github.com/yourusername/kv-store-api.git
   cd kv-store-api
   ```

2. **Настройка окружения**:
   Убедитесь, что на вашем компьютере установлены Docker и Docker Compose.

3. **Запуск приложения**:

   ```bash
   docker-compose up --build
   ```

   Эта команда запустит как Tarantool, так и API сервис в контейнерах Docker.

4. **Доступ к API**:
   API будет доступен по адресу `http://localhost:8081`.

## Тестирование

Интеграционные тесты для всех эндпоинтов API находятся в каталоге `tests/`. Для запуска тестов выполните:

```bash
docker-compose exec api go test ./tests/...
```
